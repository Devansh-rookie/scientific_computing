eps = 1e-6
def rk_4_method(x0, y0, h, func):
    k1 = h*func(x0, y0)
    k2 = h*func(x0+h/2, y0+k1/2)
    k3 = h*func(x0+h/2, y0+k2/2)
    k4 = h*func(x0 + h, y0 + k3)
    return y0 + (k1 + 2*k2 + 2*k3 + k4)/6


def adam_moulton(f, x0, y0, h, xn):
    n = int((xn - x0) / h)
    x = [x0]
    y = [y0]

    for i in range(3):
        y.append(rk_4_method(x[i], y[i], h, f))
        x.append(round(x[i] + h, 6))

    for i in range(3, n):
        pred = y[-1] + h*(55*f(x[-1], y[-1]) - 59*f(x[-2], y[-2]) + 37*f(x[-3], y[-3]) - 9*f(x[-4], y[-4]))/24
        corrected = y[-1] + h*(9*f(x[-1] + h, pred) + 19*f(x[-1], y[-1]) - 5*f(x[-2], y[-2]) + f(x[-3], y[-3]))/24
        y.append(corrected)
        x.append(round(x[i] + h, 6))

    return x, y


if __name__ == "__main__":
    x0 = 0
    y0 = 1
    h = 0.01
    xn = 0.4
    def f(x, y):
        return x*y + y*y
    x_list, y_list = adam_moulton(f, x0, y0, h, xn)
    # print(x_list)
    # print(y_list)

    for i in range(len(x_list)):
        print(f"x = {x_list[i]}, y = {y_list[i]}")

'''
x = 0, y = 1
x = 0.01, y = 1.0101516864751878
x = 0.02, y = 1.0206136539790684
x = 0.03, y = 1.0313966424471661
x = 0.04, y = 1.0425119204350979
x = 0.05, y = 1.0539713148194483
x = 0.06, y = 1.065787247258748
x = 0.07, y = 1.077972770353399
x = 0.08, y = 1.0905416072810563
x = 0.09, y = 1.1035081944719585
x = 0.1, y = 1.1168877275918372
x = 0.11, y = 1.1306962111362302
x = 0.12, y = 1.1449505119712107
x = 0.13, y = 1.1596684171915752
x = 0.14, y = 1.174868696707948
x = 0.15, y = 1.1905711710196927
x = 0.16, y = 1.2067967846816796
x = 0.17, y = 1.2235676860306468
x = 0.18, y = 1.240907313802063
x = 0.19, y = 1.2588404913421356
x = 0.2, y = 1.2773935292031837
x = 0.21, y = 1.2965943370054902
x = 0.22, y = 1.3164725455566924
x = 0.23, y = 1.3370596403427866
x = 0.24, y = 1.3583891076452936
x = 0.25, y = 1.38049659469984
x = 0.26, y = 1.40342008549566
x = 0.27, y = 1.4272000940272083
x = 0.28, y = 1.4518798770527976
x = 0.29, y = 1.4775056686964358
x = 0.3, y = 1.504126939554354
x = 0.31, y = 1.531796683344907
x = 0.32, y = 1.560571734578933
x = 0.33, y = 1.5905131212385344
x = 0.34, y = 1.6216864570491405
x = 0.35, y = 1.6541623786290303
x = 0.36, y = 1.6880170336221532
x = 0.37, y = 1.7233326268883165
x = 0.38, y = 1.7601980329692724
x = 0.39, y = 1.7987094844062947
x = 0.4, y = 1.8389713470992972
'''
